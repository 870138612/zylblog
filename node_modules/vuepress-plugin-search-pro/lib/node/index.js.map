{"version":3,"file":"index.js","sources":["../../src/node/utils.ts","../../src/node/compact/utils.ts","../../src/node/compact/convert.ts","../../src/node/excerpt.ts","../../src/node/generateIndex.ts","../../src/node/generateWorker.ts","../../src/node/locales.ts","../../src/node/prepare.ts","../../src/node/plugin.ts","../../src/shared/data.ts"],"sourcesContent":["import { getDirname, path } from \"@vuepress/utils\";\nimport { Logger, ensureEndingSlash } from \"vuepress-shared/node\";\n\nconst __dirname = getDirname(import.meta.url);\n\nexport const CLIENT_FOLDER = ensureEndingSlash(\n  path.resolve(__dirname, \"../client/\")\n);\n\nexport const WORKER_FOLDER = ensureEndingSlash(\n  path.resolve(__dirname, \"../worker/\")\n);\n\nexport const PLUGIN_NAME = \"vuepress-plugin-search-pro\";\n\nexport const logger = new Logger(PLUGIN_NAME);\n\nexport const getLocaleChunkName = (locale: string): string =>\n  locale.replace(/\\//g, \"\") || \"root\";\n","import { colors } from \"@vuepress/utils\";\n\nimport { logger } from \"../utils.js\";\n\nexport interface DeprecatedLoggerOptions {\n  options: Record<string, unknown>;\n  deprecatedOption: string;\n  newOption: string;\n  msg?: string;\n  scope?: string;\n}\n\nexport const deprecatedLogger = ({\n  options,\n  deprecatedOption,\n  newOption,\n  msg = \"\",\n  scope = \"\",\n}: DeprecatedLoggerOptions): void => {\n  if (deprecatedOption in options) {\n    logger.warn(\n      `${colors.magenta(deprecatedOption)} is ${colors.yellow(\"deprecated\")}${\n        scope ? ` in ${scope}` : \"\"\n      }, please use \"${colors.magenta(newOption)}\" instead.${\n        msg ? `\\n${msg}` : \"\"\n      }`\n    );\n\n    if (newOption.includes(\".\")) {\n      const keys = newOption.split(\".\");\n      let temp = options;\n\n      keys.forEach((key, index) => {\n        if (index !== keys.length - 1) {\n          // ensure level exists\n          temp[key] = temp[key] || {};\n\n          temp = temp[key] as Record<string, unknown>;\n        } else {\n          temp[key] = options[deprecatedOption];\n        }\n      });\n    } else {\n      options[newOption] = options[deprecatedOption];\n    }\n\n    delete options[deprecatedOption];\n  }\n};\n","import { deprecatedLogger } from \"./utils.js\";\nimport { type SearchProOptions } from \"../options.js\";\n\n/** @deprecated */\nexport const convertOptions = (\n  options: SearchProOptions & Record<string, unknown>\n): void => {\n  deprecatedLogger({\n    options,\n    deprecatedOption: \"fullIndex\",\n    newOption: \"indexContent\",\n  });\n  deprecatedLogger({\n    options,\n    deprecatedOption: \"historyCount\",\n    newOption: \"resultHistoryCount\",\n  });\n  deprecatedLogger({\n    options,\n    deprecatedOption: \"delay\",\n    newOption: \"searchDelay\",\n  });\n};\n","import { type App, type Page } from \"@vuepress/core\";\nimport { getPageExcerpt } from \"vuepress-shared/node\";\n\nexport const setPageExcerpt = (app: App): void => {\n  const { pages, pluginApi } = app;\n  const isBlogPluginEnabled = pluginApi.plugins.some(\n    ({ name }) => name === \"vuepress-plugin-blog2\"\n  );\n  const hasExcerpt =\n    isBlogPluginEnabled || pages.some((page) => \"excerpt\" in page.data);\n\n  if (!hasExcerpt)\n    pages.forEach((page: Page<{ excerpt?: string }>) => {\n      page.data[\"excerpt\"] = getPageExcerpt(app, page, {\n        excerptLength: 0,\n      });\n    });\n};\n","import { type App, type Page } from \"@vuepress/core\";\nimport { type AnyNode, type Element, load } from \"cheerio\";\nimport { addAllAsync, createIndex } from \"slimsearch\";\nimport { entries, fromEntries, isArray, keys } from \"vuepress-shared/node\";\n\nimport {\n  type SearchProCustomFieldOptions,\n  type SearchProOptions,\n} from \"./options.js\";\nimport {\n  type IndexItem,\n  type LocaleIndex,\n  type PageIndexId,\n  type PageIndexItem,\n  type SearchIndexStore,\n  type SectionIndexItem,\n} from \"../shared/index.js\";\n\n/**\n * These tags are valid HTML tags which can contain content.\n */\n\n/**\n * @description h1 is removed because it's the title of the page.\n */\nconst HEADING_TAGS = \"h2,h3,h4,h5,h6\".split(\",\");\n\n/**\n * @description Not all the block tags are included, because some of them shall not be indexed\n */\nconst CONTENT_BLOCK_TAGS =\n  \"header,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,li,main,ol,p,ul,caption,table,thead,tbody,tfoot,th,tr,td,datalist,fieldset,form,legend,optgroup,option,select,details,dialog,menu,menuitem,summary,blockquote,pre\".split(\n    \",\"\n  );\n\n/**\n * @description Not all the inline tags are included, because some of them shall not be indexed, e.g.: pre\n *\n * routerlink is added to the list, because it is a special link tag\n */\nconst CONTENT_INLINE_TAGS =\n  \"routerlink,a,b,abbr,bdi,bdo,cite,code,dfn,em,i,kbd,mark,q,rp,rt,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,del,ins,button,label,legend,meter,optgroup,option,output,progress,select\".split(\n    \",\"\n  );\n\nconst $ = load(\"\");\n\nconst renderHeader = (node: Element): string =>\n  node.children\n    .map((node) => {\n      if (node.type === \"tag\") {\n        // drop anchor\n        if (node.name === \"a\" && node.attribs[\"class\"] === \"header-anchor\")\n          return \"\";\n\n        return renderHeader(node);\n      }\n\n      if (node.type === \"text\") return node.data;\n\n      return \"\";\n    })\n    .join(\" \")\n    .replace(/\\s+/gu, \" \")\n    .trim();\n\nexport const generatePageIndex = (\n  page: Page<{ excerpt?: string }>,\n  customFieldsGetter: SearchProCustomFieldOptions[] = [],\n  indexContent = false\n): IndexItem[] => {\n  const { contentRendered, data, title } = page;\n  const key = <PageIndexId>page.key;\n  const hasExcerpt = \"excerpt\" in data && data[\"excerpt\"].length;\n\n  const pageIndex: PageIndexItem = { id: key, h: title };\n  const results: IndexItem[] = [pageIndex];\n\n  // here are some variables holding the current state of the parser\n  let shouldIndexContent = hasExcerpt || indexContent;\n  let currentSectionIndex: SectionIndexItem | null = null;\n  let currentContent = \"\";\n  let isContentBeforeFirstHeader = true;\n\n  const render = (node: AnyNode, preserveSpace = false): void => {\n    if (node.type === \"tag\") {\n      if (HEADING_TAGS.includes(node.name)) {\n        if (currentContent && shouldIndexContent) {\n          // add last content\n          // add last content\n          ((isContentBeforeFirstHeader ? pageIndex : currentSectionIndex!).t ??=\n            []).push(currentContent.replace(/\\s+/gu, \" \"));\n          currentContent = \"\";\n        }\n\n        if (isContentBeforeFirstHeader) isContentBeforeFirstHeader = false;\n        else results.push(currentSectionIndex!);\n\n        // update current section index\n        currentSectionIndex = {\n          id: `${key}#${node.attribs[\"id\"]}`,\n          h: renderHeader(node),\n        };\n      } else if (CONTENT_BLOCK_TAGS.includes(node.name)) {\n        if (currentContent && shouldIndexContent) {\n          // add last content\n          ((isContentBeforeFirstHeader ? pageIndex : currentSectionIndex)!.t ??=\n            []).push(currentContent.replace(/\\s+/gu, \" \"));\n          currentContent = \"\";\n        }\n        node.childNodes.forEach((item) =>\n          render(item, preserveSpace || node.name === \"pre\")\n        );\n      } else if (CONTENT_INLINE_TAGS.includes(node.name)) {\n        node.childNodes.forEach((item) => render(item, preserveSpace));\n      }\n    } else if (node.type === \"text\") {\n      currentContent += preserveSpace || node.data.trim() ? node.data : \"\";\n    } else if (\n      // we are expecting to stop at excerpt marker\n      hasExcerpt &&\n      !indexContent &&\n      // we got excerpt marker\n      node.type === \"comment\" &&\n      node.data.trim() === \"more\"\n    ) {\n      shouldIndexContent = false;\n    }\n  };\n\n  const nodes = $.parseHTML(contentRendered);\n\n  // get custom fields\n  const customFields = fromEntries(\n    customFieldsGetter\n      .map(({ getter }, index) => {\n        const result = getter(page);\n\n        return isArray(result)\n          ? [index.toString(), result]\n          : result\n          ? [index.toString(), [result]]\n          : null;\n      })\n      .filter((item): item is [string, string[]] => item !== null)\n  );\n\n  // no content in page and no customFields\n  if (!nodes?.length && !keys(customFields).length) return [];\n\n  // walk through nodes and extract indexes\n  nodes?.forEach((node) => {\n    render(node);\n  });\n\n  // push contents in last block tags\n  if (shouldIndexContent && currentContent)\n    ((isContentBeforeFirstHeader ? pageIndex : currentSectionIndex)!.t ??=\n      []).push(currentContent);\n\n  // push last section\n  if (currentSectionIndex) results.push(currentSectionIndex);\n\n  // add custom fields\n  entries(customFields).forEach(([customField, values]) => {\n    results.push({\n      id: `${key}@${customField}`,\n      c: values,\n    });\n  });\n\n  return results;\n};\n\nexport const getSearchIndexStore = async (\n  app: App,\n  {\n    customFields,\n    indexContent,\n    indexOptions,\n    indexLocaleOptions,\n  }: SearchProOptions\n): Promise<SearchIndexStore> => {\n  const indexesByLocale: LocaleIndex = {};\n\n  app.pages.forEach((page) => {\n    const indexes = generatePageIndex(page, customFields, indexContent);\n\n    (indexesByLocale[page.pathLocale] ??= []).push(...indexes);\n  });\n\n  const searchIndex: SearchIndexStore = {};\n\n  await Promise.all(\n    entries(indexesByLocale).map(async ([localePath, indexes]) => {\n      const index = createIndex<IndexItem, string>({\n        ...indexOptions,\n        ...indexLocaleOptions?.[localePath],\n        fields: [/** heading */ \"h\", /** text */ \"t\", /** customFields */ \"c\"],\n        storeFields: [\n          /** heading */ \"h\",\n          /** anchor */ \"a\",\n          /** text */ \"t\",\n          /** customFields */ \"c\",\n        ],\n      });\n\n      await addAllAsync(index, indexes);\n\n      searchIndex[localePath] = index;\n    })\n  );\n\n  return searchIndex;\n};\n","import { type App } from \"@vuepress/core\";\nimport { fs, path } from \"@vuepress/utils\";\n\nimport { getSearchIndexStore } from \"./generateIndex.js\";\nimport { type SearchProOptions } from \"./options.js\";\nimport { WORKER_FOLDER } from \"./utils.js\";\n\nexport const generateWorker = async (\n  app: App,\n  options: SearchProOptions\n): Promise<void> => {\n  const workerFilePath = app.dir.dest(options.worker || \"search-pro.worker.js\");\n  const searchIndexContent = JSON.stringify(\n    await getSearchIndexStore(app, options)\n  );\n  const workerPath = `${WORKER_FOLDER}index.js`;\n\n  const workerFileContent = await fs.readFile(workerPath, \"utf8\");\n\n  await fs.ensureDir(path.dirname(workerFilePath));\n  await fs.writeFile(\n    workerFilePath,\n    workerFileContent.replace(\n      \"SEARCH_PRO_INDEX\",\n      () => `${JSON.stringify(searchIndexContent)}`\n    )\n  );\n};\n","import { type SearchProLocaleConfig } from \"../shared/index.js\";\n\n/** Multi language config for search-pro popup */\nexport const searchProLocales: SearchProLocaleConfig = {\n  \"/en/\": {\n    cancel: \"Cancel\",\n    placeholder: \"Search\",\n    search: \"Search\",\n    searching: \"Searching\",\n    defaultTitle: \"Documentation\",\n    select: \"to select\",\n    navigate: \"to navigate\",\n    autocomplete: \"to autocomplete\",\n    exit: \"to exit\",\n    history: \"Search History\",\n    emptyHistory: \"Empty Search History\",\n    emptyResult: \"No results found\",\n    loading: \"Loading search indexes...\",\n  },\n\n  \"/zh/\": {\n    cancel: \"取消\",\n    placeholder: \"搜索\",\n    search: \"搜索\",\n    searching: \"搜索中\",\n    defaultTitle: \"文档\",\n    select: \"选择\",\n    navigate: \"切换\",\n    autocomplete: \"自动补全\",\n    exit: \"关闭\",\n    history: \"搜索历史\",\n    emptyHistory: \"无搜索历史\",\n    emptyResult: \"没有找到结果\",\n    loading: \"正在加载搜索索引...\",\n  },\n\n  \"/zh-tw/\": {\n    cancel: \"取消\",\n    placeholder: \"搜索\",\n    search: \"搜素\",\n    searching: \"搜索中\",\n    defaultTitle: \"文檔\",\n    select: \"選擇\",\n    navigate: \"切換\",\n    autocomplete: \"自動補全\",\n    exit: \"關閉\",\n    history: \"搜索歷史\",\n    emptyHistory: \"無搜索歷史\",\n    emptyResult: \"沒有找到結果\",\n    loading: \"正在加載搜索索引...\",\n  },\n\n  \"/de/\": {\n    cancel: \"Abbrechen\",\n    placeholder: \"Suche\",\n    search: \"Suche\",\n    searching: \"Suche\",\n    defaultTitle: \"Dokumentation\",\n    select: \"auswählen\",\n    navigate: \"wechseln\",\n    autocomplete: \"automatisch vervollständigen\",\n    exit: \"schließen\",\n    history: \"Suchverlauf\",\n    emptyHistory: \"Suchverlauf leeren\",\n    emptyResult: \"Keine Ergebnisse gefunden\",\n    loading: \"Suchindex wird geladen...\",\n  },\n\n  \"/de-at/\": {\n    cancel: \"Abbrechen\",\n    placeholder: \"Suche\",\n    search: \"Suche\",\n    searching: \"Suche\",\n    defaultTitle: \"Dokumentation\",\n    select: \"auswählen\",\n    navigate: \"wechseln\",\n    autocomplete: \"automatisch vervollständigen\",\n    exit: \"schließen\",\n    history: \"Suchverlauf\",\n    emptyHistory: \"Suchverlauf leeren\",\n    emptyResult: \"Keine Ergebnisse gefunden\",\n    loading: \"Suchindex wird geladen...\",\n  },\n\n  \"/vi/\": {\n    cancel: \"Hủy\",\n    placeholder: \"Tìm kiếm\",\n    search: \"Tìm kiếm\",\n    searching: \"Đang tìm kiếm\",\n    defaultTitle: \"Tài liệu\",\n    select: \"chọn\",\n    navigate: \"chuyển\",\n    autocomplete: \"tự động hoàn thành\",\n    exit: \"đóng\",\n    history: \"Lịch sử tìm kiếm\",\n    emptyHistory: \"Xóa lịch sử tìm kiếm\",\n    emptyResult: \"Không tìm thấy kết quả\",\n    loading: \"Đang tải chỉ mục tìm kiếm...\",\n  },\n\n  \"/uk/\": {\n    cancel: \"Скасувати\",\n    placeholder: \"Пошук\",\n    search: \"Пошук\",\n    searching: \"Пошук\",\n    defaultTitle: \"Документація\",\n    select: \"вибрати\",\n    navigate: \"перейти\",\n    autocomplete: \"автозаповнення\",\n    exit: \"закрити\",\n    history: \"Історія пошуку\",\n    emptyHistory: \"Очистити історію пошуку\",\n    emptyResult: \"Нічого не знайдено\",\n    loading: \"Завантаження пошукових індексів...\",\n  },\n\n  \"/ru/\": {\n    cancel: \"Отмена\",\n    placeholder: \"Поиск\",\n    search: \"Поиск\",\n    searching: \"Поиск\",\n    defaultTitle: \"Документация\",\n    select: \"выбрать\",\n    navigate: \"переключить\",\n    autocomplete: \"автозаполнение\",\n    exit: \"закрыть\",\n    history: \"История поиска\",\n    emptyHistory: \"Очистить историю поиска\",\n    emptyResult: \"Ничего не найдено\",\n    loading: \"Загрузка поисковых индексов...\",\n  },\n\n  \"/br/\": {\n    cancel: \"Cancelar\",\n    placeholder: \"Pesquisar\",\n    search: \"Pesquisar\",\n    searching: \"Pesquisando\",\n    defaultTitle: \"Documentação\",\n    select: \"selecionar\",\n    navigate: \"navegar\",\n    autocomplete: \"autocompletar\",\n    exit: \"fechar\",\n    history: \"Histórico de pesquisa\",\n    emptyHistory: \"Limpar histórico de pesquisa\",\n    emptyResult: \"Nenhum resultado encontrado\",\n    loading: \"Carregando índices de pesquisa...\",\n  },\n\n  \"/pl/\": {\n    cancel: \"Anuluj\",\n    placeholder: \"Szukaj\",\n    search: \"Szukaj\",\n    searching: \"Szukanie\",\n    defaultTitle: \"Dokumentacja\",\n    select: \"wybierz\",\n    navigate: \"przejdź\",\n    autocomplete: \"autouzupełnianie\",\n    exit: \"zamknij\",\n    history: \"Historia wyszukiwania\",\n    emptyHistory: \"Wyczyść historię wyszukiwania\",\n    emptyResult: \"Nie znaleziono wyników\",\n    loading: \"Ładowanie indeksów wyszukiwania...\",\n  },\n\n  \"/sk/\": {\n    cancel: \"Zrušiť\",\n    placeholder: \"Hľadať\",\n    search: \"Hľadať\",\n    searching: \"Hľadanie\",\n    defaultTitle: \"Dokumentácia\",\n    select: \"vybrať\",\n    navigate: \"prepnúť\",\n    autocomplete: \"automatické dopĺňanie\",\n    exit: \"zavrieť\",\n    history: \"História vyhľadávania\",\n    emptyHistory: \"Vymazať históriu vyhľadávania\",\n    emptyResult: \"Nenašli sa žiadne výsledky\",\n    loading: \"Načítavajú sa vyhľadávacie indexy...\",\n  },\n\n  \"/fr/\": {\n    cancel: \"Annuler\",\n    placeholder: \"Rechercher\",\n    search: \"Rechercher\",\n    searching: \"Recherche\",\n    defaultTitle: \"Documentation\",\n    select: \"sélectionner\",\n    navigate: \"naviguer\",\n    autocomplete: \"auto-complétion\",\n    exit: \"fermer\",\n    history: \"Historique de recherche\",\n    emptyHistory: \"Vider l'historique de recherche\",\n    emptyResult: \"Aucun résultat trouvé\",\n    loading: \"Chargement des index de recherche...\",\n  },\n\n  \"/es/\": {\n    cancel: \"Cancelar\",\n    placeholder: \"Buscar\",\n    search: \"Buscar\",\n    searching: \"Buscando\",\n    defaultTitle: \"Documentación\",\n    select: \"seleccionar\",\n    navigate: \"navegar\",\n    autocomplete: \"autocompletar\",\n    exit: \"cerrar\",\n    history: \"Historial de búsqueda\",\n    emptyHistory: \"Vaciar historial de búsqueda\",\n    emptyResult: \"No se encontraron resultados\",\n    loading: \"Cargando índices de búsqueda...\",\n  },\n\n  \"/ja/\": {\n    cancel: \"キャンセル\",\n    placeholder: \"検索\",\n    search: \"検索\",\n    searching: \"検索中\",\n    defaultTitle: \"ドキュメント\",\n    select: \"選択\",\n    navigate: \"切り替え\",\n    autocomplete: \"オートコンプリート\",\n    exit: \"閉じる\",\n    history: \"検索履歴\",\n    emptyHistory: \"検索履歴をクリア\",\n    emptyResult: \"結果が見つかりません\",\n    loading: \"検索インデックスを読み込んでいます...\",\n  },\n\n  \"/tr/\": {\n    cancel: \"İptal\",\n    placeholder: \"Ara\",\n    search: \"Ara\",\n    searching: \"Aranıyor\",\n    defaultTitle: \"Dökümantasyon\",\n    select: \"seç\",\n    navigate: \"geç\",\n    autocomplete: \"otomatik tamamlama\",\n    exit: \"kapat\",\n    history: \"Arama geçmişi\",\n    emptyHistory: \"Arama geçmişini temizle\",\n    emptyResult: \"Sonuç bulunamadı\",\n    loading: \"Arama dizinleri yükleniyor...\",\n  },\n\n  \"/ko/\": {\n    cancel: \"취소\",\n    placeholder: \"검색\",\n    search: \"검색\",\n    searching: \"검색 중\",\n    defaultTitle: \"문서\",\n    select: \"선택\",\n    navigate: \"이동\",\n    autocomplete: \"자동 완성\",\n    exit: \"닫기\",\n    history: \"검색 기록\",\n    emptyHistory: \"검색 기록 지우기\",\n    emptyResult: \"결과를 찾을 수 없습니다\",\n    loading: \"검색 인덱스를 로드하는 중...\",\n  },\n\n  \"/fi/\": {\n    cancel: \"Peruuta\",\n    placeholder: \"Etsi\",\n    search: \"Etsi\",\n    searching: \"Etsitään\",\n    defaultTitle: \"Dokumentaatio\",\n    select: \"valitaksesi\",\n    navigate: \"navigoidaksesi\",\n    autocomplete: \"automaattinen täydennys\",\n    exit: \"poistuaksesi\",\n    history: \"Hakuhistoria\",\n    emptyHistory: \"Tyhjennä hakuhistoria\",\n    emptyResult: \"Tuloksia ei löytynyt\",\n    loading: \"Ladataan hakuindeksiä...\",\n  },\n\n  \"/hu/\": {\n    cancel: \"Mégse\",\n    placeholder: \"Keresés\",\n    search: \"Keresés\",\n    searching: \"Keresés\",\n    defaultTitle: \"Dokumentáció\",\n    select: \"kiválasztáshoz\",\n    navigate: \"navigáláshoz\",\n    autocomplete: \"automatikus kiegészítés\",\n    exit: \"kilépéshez\",\n    history: \"Keresési előzmények\",\n    emptyHistory: \"Üres keresési előzmények\",\n    emptyResult: \"Nincs találat\",\n    loading: \"A keresési indexek betöltése...\",\n  },\n\n  \"/id/\": {\n    cancel: \"Batal\",\n    placeholder: \"Cari sesuatu 🔎\",\n    search: \"Cari\",\n    searching: \"Sedang mencari\",\n    defaultTitle: \"Dokumentasi\",\n    select: \"pilih\",\n    navigate: \"navigasi\",\n    autocomplete: \"autoselesai\",\n    exit: \"keluar\",\n    history: \"Riwayat Penelusuran\",\n    emptyHistory: \"Tidak ada riwayat penelusuran\",\n    emptyResult: \"Hasil penelusuran tidak tersedia\",\n    loading: \"Memuat indeks penelusuran...\",\n  },\n\n  \"/nl/\": {\n    cancel: \"Annuleren\",\n    placeholder: \"Zoeken\",\n    search: \"Zoeken\",\n    searching: \"Zoeken\",\n    defaultTitle: \"Documentatie\",\n    select: \"Selecteren\",\n    navigate: \"to navigate\",\n    autocomplete: \"autocompletion\",\n    exit: \"to exit\",\n    history: \"Zoekgeschiedenis\",\n    emptyHistory: \"Zoekgeschiedenis Leegmaken\",\n    emptyResult: \"Geen resultaten gevonden\",\n    loading: \"Laden van zoekindexen...\",\n  },\n};\n","import { type App } from \"@vuepress/core\";\nimport { addAll, discard, vacuum } from \"slimsearch\";\nimport { entries, keys } from \"vuepress-shared/node\";\n\nimport { generatePageIndex, getSearchIndexStore } from \"./generateIndex.js\";\nimport { type SearchProOptions } from \"./options.js\";\nimport { getLocaleChunkName } from \"./utils.js\";\nimport { type SearchIndexStore } from \"../shared/index.js\";\n\nlet previousSearchIndexStore: SearchIndexStore | null = null;\n\nexport const prepareSearchIndex = async (\n  app: App,\n  options: SearchProOptions\n): Promise<void> => {\n  if (app.env.isDev) {\n    const searchIndexStore = await getSearchIndexStore(app, options);\n\n    previousSearchIndexStore = searchIndexStore;\n\n    await Promise.all(\n      entries(searchIndexStore).map(([locale, documents]) =>\n        app.writeTemp(\n          `search-pro/${getLocaleChunkName(locale)}.js`,\n          `export default ${JSON.stringify(JSON.stringify(documents))};`\n        )\n      )\n    );\n\n    await app.writeTemp(\n      `search-pro/index.js`,\n      `export default {${keys(searchIndexStore)\n        .map(\n          (locale) =>\n            `${JSON.stringify(locale)}: () => import('./${getLocaleChunkName(\n              locale\n            )}.js')`\n        )\n        .join(\",\")}}`\n    );\n  }\n};\n\nexport const updateSearchIndex = async (\n  app: App,\n  options: SearchProOptions,\n  path: string\n): Promise<void> => {\n  if (previousSearchIndexStore) {\n    const actualPath = path\n      .replace(/^pages\\//, \"\")\n      .replace(/\\/index\\.html\\.vue/, \"/readme.md\")\n      .replace(/\\.html\\.vue/, \".md\");\n\n    const { pages, writeTemp } = app;\n\n    const page = pages.find(\n      ({ filePathRelative }) =>\n        filePathRelative?.toLowerCase() === actualPath.toLowerCase()\n    )!;\n\n    if (page) {\n      const pageIndexes = generatePageIndex(\n        page,\n        options.customFields,\n        options.indexContent\n      );\n      const { pathLocale, key } = page;\n      const localeSearchIndex = previousSearchIndexStore[pathLocale];\n\n      // update index\n      if (pageIndexes) {\n        // remove previous index\n        Array.from(localeSearchIndex._documentIds.values())\n          .filter((id) => id.startsWith(key))\n          .forEach((id) => discard(localeSearchIndex, id));\n\n        addAll(localeSearchIndex, pageIndexes);\n\n        await vacuum(localeSearchIndex);\n\n        // search index file content\n        const content = `\\\nexport default ${JSON.stringify(JSON.stringify(localeSearchIndex))}\n`;\n\n        await writeTemp(\n          `search-pro/${getLocaleChunkName(pathLocale)}.js`,\n          content\n        );\n\n        return;\n      }\n    }\n  }\n\n  await prepareSearchIndex(app, options);\n};\n\nexport const removeSearchIndex = async (\n  app: App,\n  options: SearchProOptions,\n  path: string\n): Promise<void> => {\n  if (previousSearchIndexStore) {\n    const actualPath = path\n      .replace(/^pages\\//, \"\")\n      .replace(/\\/index\\.html\\.vue/, \"/readme.md\")\n      .replace(/\\.html\\.vue/, \".md\");\n\n    const { pages, writeTemp } = app;\n\n    const page = pages.find(\n      ({ filePathRelative }) =>\n        filePathRelative?.toLowerCase() === actualPath.toLowerCase()\n    )!;\n\n    if (page) {\n      const { pathLocale, key } = page;\n      const localeSearchIndex = previousSearchIndexStore[pathLocale];\n\n      // remove previous index\n      Array.from(localeSearchIndex._documentIds.values())\n        .filter((id) => id.startsWith(key))\n        .forEach((id) => discard(localeSearchIndex, id));\n\n      await vacuum(localeSearchIndex);\n\n      // search index file content\n      const content = `\\\nexport default ${JSON.stringify(JSON.stringify(localeSearchIndex))}\n`;\n\n      await writeTemp(\n        `search-pro/${getLocaleChunkName(pathLocale)}.js`,\n        content\n      );\n\n      return;\n    }\n  }\n\n  await prepareSearchIndex(app, options);\n};\n","import { type PluginFunction } from \"@vuepress/core\";\nimport { watch } from \"chokidar\";\nimport { useSassPalettePlugin } from \"vuepress-plugin-sass-palette\";\nimport {\n  addViteOptimizeDepsInclude,\n  addViteSsrNoExternal,\n  checkVersion,\n  fromEntries,\n  getLocales,\n} from \"vuepress-shared/node\";\n\nimport { convertOptions } from \"./compact/index.js\";\nimport { setPageExcerpt } from \"./excerpt.js\";\nimport { generateWorker } from \"./generateWorker.js\";\nimport { searchProLocales } from \"./locales.js\";\nimport { type SearchProOptions } from \"./options.js\";\nimport {\n  prepareSearchIndex,\n  removeSearchIndex,\n  updateSearchIndex,\n} from \"./prepare.js\";\nimport { CLIENT_FOLDER, PLUGIN_NAME, logger } from \"./utils.js\";\n\nexport const searchProPlugin =\n  (options: SearchProOptions, legacy = true): PluginFunction =>\n  (app) => {\n    // TODO: Remove this in v2 stable\n    if (legacy)\n      convertOptions(options as SearchProOptions & Record<string, unknown>);\n\n    useSassPalettePlugin(app, { id: \"hope\" });\n\n    checkVersion(app, PLUGIN_NAME, \"2.0.0-beta.63\");\n\n    if (app.env.isDebug) logger.info(\"Options:\", options);\n\n    return {\n      name: PLUGIN_NAME,\n\n      alias: {\n        [`${PLUGIN_NAME}/result`]: `${CLIENT_FOLDER}components/SearchResult.js`,\n      },\n\n      define: {\n        SEARCH_PRO_ENABLE_AUTO_SUGGESTIONS: options.autoSuggestions !== false,\n        SEARCH_PRO_CUSTOM_FIELDS: fromEntries(\n          (options.customFields || [])\n            .map(({ formatter }, index) =>\n              formatter ? [index.toString(), formatter] : null\n            )\n            .filter((item): item is [string, string] => item !== null)\n        ),\n        SEARCH_PRO_LOCALES: getLocales({\n          app,\n          name: PLUGIN_NAME,\n          config: options.locales,\n          default: searchProLocales,\n        }),\n        SEARCH_PRO_OPTIONS: {\n          searchDelay: options.searchDelay || 150,\n          suggestDelay: options.suggestDelay || 0,\n          queryHistoryCount: options.queryHistoryCount || 5,\n          resultHistoryCount: options.resultHistoryCount || 5,\n          hotKeys: options.hotKeys || [\n            { key: \"k\", ctrl: true },\n            { key: \"/\", ctrl: true },\n          ],\n          worker: options.worker || \"search-pro.worker.js\",\n        },\n      },\n\n      clientConfigFile: `${CLIENT_FOLDER}config.js`,\n\n      extendsBundlerOptions: (bundlerOptions: unknown, app): void => {\n        addViteOptimizeDepsInclude(bundlerOptions, app, \"slimsearch\");\n        addViteSsrNoExternal(bundlerOptions, app, [\n          \"fflate\",\n          \"vuepress-shared\",\n        ]);\n      },\n\n      onInitialized: (app): void => setPageExcerpt(app),\n\n      onPrepared: (app): Promise<void> => prepareSearchIndex(app, options),\n\n      onWatched: (app, watchers): void => {\n        const hotReload =\n          \"hotReload\" in options ? options.hotReload : app.env.isDebug;\n\n        if (hotReload) {\n          // this ensure the page is generated or updated\n          const searchIndexWatcher = watch(\"pages/**/*.vue\", {\n            cwd: app.dir.temp(),\n            ignoreInitial: true,\n          });\n\n          searchIndexWatcher.on(\"add\", (path) => {\n            void updateSearchIndex(app, options, path);\n          });\n          searchIndexWatcher.on(\"change\", (path) => {\n            void updateSearchIndex(app, options, path);\n          });\n          searchIndexWatcher.on(\"unlink\", (path) => {\n            void removeSearchIndex(app, options, path);\n          });\n\n          watchers.push(searchIndexWatcher);\n        }\n      },\n\n      onGenerated: (app) => generateWorker(app, options),\n    };\n  };\n","import { type SearchIndex } from \"slimsearch\";\n\nexport const enum IndexField {\n  heading = \"h\",\n  anchor = \"a\",\n  text = \"t\",\n  customFields = \"c\",\n}\n\nexport type PageIndexId = `v-${string}`;\n\nexport interface PageIndexItem {\n  id: PageIndexId;\n  /** heading */ h: string;\n  /** text */ t?: string[];\n}\n\nexport type SectionIndexId = `${PageIndexId}#${string}`;\n\nexport interface SectionIndexItem {\n  id: SectionIndexId;\n  /** heading */ h: string;\n  /** text */ t?: string[];\n}\n\nexport type CustomFieldIndexID = `${PageIndexId}@${number}`;\n\nexport interface CustomFieldIndexItem {\n  id: string;\n  /** customFields */ c: string[];\n}\n\nexport type IndexItem = PageIndexItem | SectionIndexItem | CustomFieldIndexItem;\n\nexport type LocaleIndex = Record<string, IndexItem[]>;\n\nexport type SearchIndexStore = Record<string, SearchIndex<IndexItem, string>>;\n"],"names":["__dirname","getDirname","CLIENT_FOLDER","ensureEndingSlash","path","WORKER_FOLDER","PLUGIN_NAME","logger","Logger","getLocaleChunkName","locale","deprecatedLogger","options","deprecatedOption","newOption","msg","scope","colors","keys","temp","key","index","convertOptions","setPageExcerpt","app","pages","pluginApi","name","page","getPageExcerpt","HEADING_TAGS","CONTENT_BLOCK_TAGS","CONTENT_INLINE_TAGS","$","load","renderHeader","node","generatePageIndex","customFieldsGetter","indexContent","contentRendered","data","title","hasExcerpt","pageIndex","results","shouldIndexContent","currentSectionIndex","currentContent","isContentBeforeFirstHeader","render","preserveSpace","item","nodes","customFields","fromEntries","getter","result","isArray","entries","customField","values","getSearchIndexStore","indexOptions","indexLocaleOptions","indexesByLocale","indexes","searchIndex","localePath","createIndex","addAllAsync","generateWorker","workerFilePath","searchIndexContent","workerPath","workerFileContent","fs","searchProLocales","previousSearchIndexStore","prepareSearchIndex","searchIndexStore","documents","updateSearchIndex","actualPath","writeTemp","filePathRelative","pageIndexes","pathLocale","localeSearchIndex","id","discard","addAll","vacuum","content","removeSearchIndex","searchProPlugin","legacy","useSassPalettePlugin","checkVersion","formatter","getLocales","bundlerOptions","addViteOptimizeDepsInclude","addViteSsrNoExternal","watchers","searchIndexWatcher","watch","IndexField"],"mappings":"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"}